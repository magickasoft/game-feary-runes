/*! game-api - v0.29.1 - 2016-04-04 */
(function(e){"use strict";function t(){}function i(e){if(e=e||{},this.IS_MASTER=e.isMaster||!1,!this.IS_MASTER)throw Error("The DataStore can only be instantiated by the Master");this.dataStore={}}function a(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.IS_SLAVE=!this.IS_MASTER,this.IS_STANDALONE=e.isStandalone,this.messenger=e.messenger,this.moduleReady=t||!1,this.appTimer=null,this.appDelayMin=1e4,this.appDelayMax=24e4,this.appError=!1,this.appTimerDelay=this.appDelayMax,this.appToken=null,this.token=null}function n(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.IS_SLAVE=!this.IS_MASTER,this.IS_STANDALONE=e.isStandalone,this.messenger=e.messenger,this.eventTracking=e.eventTracking,this.appToken=e.appToken,this.moduleReady=t||!1,this.isGamestate=!1,this.endpoint=null,this.spilStorageId=null,this.flushTimer=null,this.flushDelayMin=500,this.flushDelayMax=3e4,this.flushTimerDelay=this.flushDelayMin,this.gameState={started:!1,userId:null,appId:null,dirtyKeys:[]}}function s(e,t){if(this.IS_MASTER=e&&e.isMaster?e.isMaster:!1,this.IS_SLAVE=!this.IS_MASTER,this.messenger=null,this.subscribers={},this.moduleReady=t?t:!1,this.data=e.data||null,this.gameState="resume",!e||!e.messenger)throw Error("No messenger passed to the Game module instance");this.messenger=e.messenger,window.addEventListener?window.addEventListener("message",this._performAction.bind(this),!1):window.attachEvent&&window.attachEvent("onmessage",this._performAction.bind(this)),this.IS_MASTER&&this.messenger.subscribe("gameapi.game.adjustHeight",this.adjustHeight,this)}function o(e,t){e=e||{},this.isMaster=e.isMaster,this.isStandalone=e.isStandalone,this.messenger=e.messenger,this.moduleReady=t?t:!1,this.activeLanguage="en"}function r(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.IS_STANDALONE=e.isStandalone,this.messenger=e.messenger,this.eventTracking=e.eventTracking,this.moduleReady=t?t:!1,this.isAvailable=!1,this.locale="",this.loggedIn=!1}function l(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.IS_STANDALONE=e.isStandalone,this.messenger=e.messenger,this.eventTracking=e.eventTracking,this.moduleReady=t?t:!1,this.isAvailable=!1}function p(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.IS_SLAVE=!this.IS_MASTER,this.moduleReady=t?t:!1,this.messenger=e.messenger,this.data=e.data||null,this.eventTracking=e.eventTracking,this.initialHeight=e.initialHeight,this.appToken=e.appToken,this.state={userId:null},this._setupMasterEvent()}function d(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.IS_SLAVE=!this.IS_MASTER,this.moduleReady=t?t:!1,this.messenger=e.messenger,this.data=e.data||null,this.eventTracking=e.eventTracking,this.initialHeight=e.initialHeight,this.appToken=e.appToken,this._setupMasterEvent(),this.appToken=e.appToken,this.state={userId:null}}function h(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.IS_SLAVE=!this.IS_MASTER,this.moduleReady=t?t:!1,this.messenger=e.messenger,this.data=e.data||{mapping:{}},this.eventTracking=e.eventTracking,this._setupMasterEvent()}function c(e,t){e=e||{},this.isMaster=e.isMaster,this.isStandalone=e.isStandalone,this.messenger=e.messenger,this.moduleReady=t?t:!1,this.timeoutAfter=500,this.timeout=!1,this.adRequested=!1,this.adAvailable=!1,this._callbacks={pause:!1,resume:!1}}function g(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.isStandalone=e.isStandalone,this.messenger=e.messenger,this.eventTracking=e.eventTracking,this.moduleReady=t?t:!1,this.events={GAME_START:"GAME_START",GAME_END:"GAME_END",GAME_PAUSE:"GAME_PAUSE",GAME_CONTINUE:"GAME_CONTINUE",GAME_MUTE:"GAME_MUTE",LEVEL_FAIL:"LEVEL_FAIL",LEVEL_COMPLETE:"LEVEL_COMPLETE"},this._setupEvents()}function u(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.IS_SLAVE=!this.IS_MASTER,this.IS_STANDALONE=e.isStandalone,this.data=e.data,this.messenger=e.messenger,this.moduleReady=t?t:!1,this.gamePlayTracking={started:!1,appid:null,host:null,timestamp:null},this.timeInGameTracking={started:!1,appid:null,timestamp:null},this.isGamestate=!1}function m(e,t){e=e||{},this.IS_MASTER=e.isMaster,this.IS_SLAVE=!this.IS_MASTER,this.IS_STANDALONE=e.isStandalone,this.eventTracking=e.eventTracking,this.moduleReady=t?t:!1,this.messenger=e.messenger,this.components=e.components,this.data=e.data||null}function f(e){var t="string"==typeof e?y(e):e;t&&(this.type=t.type,this.callbackId=t.callbackId,this.data=t.data)}function y(e){var t,i,a,n=!1,s=[];if("string"==typeof e&&(s=e.split("|"),"gameapi"===s[0])){s.shift(),t=s.shift(),a=parseInt(s.shift(),10),i=s.join("|");try{n={type:t,callbackId:a,data:""!==i?JSON.parse(i):""}}catch(o){}}return n}function S(e){e=e||{},this.IS_MASTER="boolean"==typeof e.isMaster?e.isMaster:!1,this.IS_SLAVE=!this.IS_MASTER,this.api=e.api?e.api:{},this._targets=e.targets?e.targets:[],this._callbacks=[],this._channels=[],this.IS_MASTER&&e.dataStore&&(this.dataStore=e.dataStore),this._setupEventListener()}function v(e,i,c,u,m){window.outerHeight-window.innerHeight,this.version="0.29.1",this.isReady=!1,this._setRole(),this.__={},this.__.dataStore=this.IS_MASTER?new e({isMaster:!0}):null,this.__.messenger=new i({isMaster:this.IS_MASTER,api:this,targets:this._getTargets(),dataStore:this.__.dataStore}),this.__.components=new t;var f=this._addBasic({});this.__.EventTracking=new u(f,!1);var y=this._addComponents(f),S=this._addEventTracking(y),v=this._addInitialHeight(S);this.AppToken=new a(S,!1),this.GameState=new n(this._addAppToken(S),!1),this.Branding=new c(S,!1),this.GameBreak=new m(f,!1),this.Game=new s(f,!1),this.Award=new d(this._addAppToken(v),!1),this.Secondscreen=new h(v,!1),this.User=new r(S,!1),this.Score=new p(this._addAppToken(v),!1),this.Friends=new l(S,!1),this.GameEvent=new g(S,!1),this.Localization=new o(S,!1)}"bind"in Function.prototype||(Function.prototype.bind=function(e){var t=this;if(1>=arguments.length)return function(){return t.apply(e,arguments)};var i=Array.prototype.slice.call(arguments,1);return function(){return t.apply(e,0===arguments.length?i:i.concat(Array.prototype.slice.call(arguments)))}}),"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e,t){void 0===t&&(t=0),0>t&&(t+=this.length),0>t&&(t=0);for(var i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1}),"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(e,t){for(void 0===t&&(t=this.length-1),0>t&&(t+=this.length),t>this.length-1&&(t=this.length-1),t++;t-->0;)if(t in this&&this[t]===e)return t;return-1}),"forEach"in Array.prototype||(Array.prototype.forEach=function(e,t){for(var i=0,a=this.length;a>i;i++)i in this&&e.call(t,this[i],i,this)}),"map"in Array.prototype||(Array.prototype.map=function(e,t){for(var i=Array(this.length),a=0,n=this.length;n>a;a++)a in this&&(i[a]=e.call(t,this[a],a,this));return i}),"filter"in Array.prototype||(Array.prototype.filter=function(e,t){for(var i,a=[],n=0,s=this.length;s>n;n++)n in this&&e.call(t,i=this[n],n,this)&&a.push(i);return a}),"every"in Array.prototype||(Array.prototype.every=function(e,t){for(var i=0,a=this.length;a>i;i++)if(i in this&&!e.call(t,this[i],i,this))return!1;return!0}),"some"in Array.prototype||(Array.prototype.some=function(e,t){for(var i=0,a=this.length;a>i;i++)if(i in this&&e.call(t,this[i],i,this))return!0;return!1});var _={timeout:3e3};_.getGameConfig=function(e){var t=!1,i=setTimeout(function(){t=!0,e()},this.timeout);SpilGames({waiton:"game.info.loaded"},["JSLib"],function(a){if(!t){clearTimeout(i);var n=a.get("current.game.integration.info");e(n)}})},_.getBrandingConfig=function(e,t){var i=!1;e=e||{portal:{},game:{}};var a=setTimeout(function(){i=!0,e.isError="no data from configar",t(e)},this.timeout),n="http://api.configar.org/cf/pb/1/configs",s=e.portal.siteId,o=e.portal.channelId,r=e.portal.applicationId,l="en-EN",p=[n,o,s,r].join("/");navigator&&"undefined"!=typeof navigator&&(navigator.languages!==void 0&&navigator.languages[0]!==void 0?l=navigator.languages[0]:navigator.userLanguage!==void 0&&(l=navigator.userLanguage)),p=p+"?locale="+l,SpilGames(["Net","JSLib"],function(n,s){n.send({url:p,type:"GET",dataType:"JSON"},function(n){if(!i){var o=function(e,t){return e.branding&&(t.branding=e.branding),e.localization&&(t.localization=e.localization),t};if(n&&n.configar)clearTimeout(a),window.postMessage(new f({type:"success",callbackId:null,data:"log.configar.getBranding.success"}),"*"),t(o(n.configar,e));else{clearTimeout(a);var r={};try{r=s.get("configar.data.cached")||r}catch(l){}t(o(r,e))}}})})};var A={};A.argsToArray=function(e){return e?Array.prototype.slice.apply(e):[]},A.isA10=function(){return/a10.com/.test(window.location.host)},A.disableKeys=function(e){var t=e.keyCode;(8===t||9===t||t>=32&&40>=t||46===t)&&e.preventDefault()},A.trackGA=function(){try{if("www8.agame.com"===window.location.host){var e=function(e,t,i,a,n,s,o){e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,s=t.createElement(i),o=t.getElementsByTagName(i)[0],s.async=1,s.src=a,o.parentNode.insertBefore(s,o)};e(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-8223336-3","auto"),ga("send","pageview")}}catch(t){}},A.getRole=function(e){var t="function"==typeof e.SpilGames,i=e.self!==e.top,a=null;if(A.isA10())return e.onkeydown=this.disableKeys,{IS_MASTER:!0,IS_SLAVE:!0,IS_STANDALONE:!0};if(t){var n=document.getElementById("#iframegame");switch(n){case"null":a={IS_MASTER:!0,IS_SLAVE:!0,IS_STANDALONE:!1};break;default:a={IS_MASTER:!0,IS_SLAVE:!1,IS_STANDALONE:!1}}}else i?(e.onkeydown=this.disableKeys,this.trackGA(),a={IS_MASTER:!1,IS_SLAVE:!0,IS_STANDALONE:!1}):(e.onkeydown=this.disableKeys,this.trackGA(),a={IS_MASTER:!0,IS_SLAVE:!0,IS_STANDALONE:!0});return a},A.callConfigar=function(e,t){var i,a,n=e.site||500,s=e.channel||100,o=e.id||null;window.XDomainRequest?(i=new XDomainRequest,i.onload=function(){t(200,i.responseText)},i.onerror=function(){t(404,null)},i.onprogress=function(){}):window.XMLHttpRequest?(i=new XMLHttpRequest,i.onreadystatechange=function(){4===i.readyState&&t(i.status,i.responseText)}):window.ActiveXObject&&(i=new ActiveXObject("Microsoft.XMLHTTP"),i.onreadystatechange=function(){4===i.readyState&&t(i.status,i.responseText)}),o&&(a=["http://api.configar.org/cf/pb/1/configs",s,n,o].join("/"),i.open("GET",a,!0),i.timeout=3e3,i.ontimeout=function(){t(404,null)},i.send())},A.submitData=function(e,t,i){var a,n=e||"",s=t||{},o=i||function(){};window.XDomainRequest?(a=new XDomainRequest,a.onload=function(){o(200,a.responseText)},a.onerror=function(){o(404,null)},a.onprogress=function(){},a.open("POST",n,!0)):window.XMLHttpRequest?(navigator.userAgent.match(/Trident\/7.0;.* rv:11/)?a=this.getJSONP():(a=new XMLHttpRequest,a.onreadystatechange=function(){4===a.readyState&&o(a.status,a.responseText)}),a.open("POST",n,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded")):window.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP"),a.onreadystatechange=function(){4===a.readyState&&o(a.status,a.responseText)},a.open("POST",n,!0)),a.timeout=3e3,a.ontimeout=function(){o(404,null)},a.send(JSON.stringify(s))},A.getJSONP=function(){var e="",t="jsonpspilgames"+ +new Date,i={open:function(t,i){t=null,e=i},onreadystatechange:function(){},setRequestHeader:function(){},set:function(e,t){i.set[e]=t},send:function(a){var n=i.set.callback||0,s=i.set.data||0;(a||n||s)&&(e+=/\?/.test(e)?"&":"?",a&&(e+=s?s+"="+encodeURIComponent(a):a,n&&(e+="&")),n&&(e+=n+"="+t));var o=document.createElement("script");o.src=e,document.getElementsByTagName("head")[0].appendChild(o)}};return window[t]=function(){i.onreadystatechange.apply(this,arguments)},i},A.xdr=function(e,t){var i,a,n=e.url||"",s=(e.type||"GET").toUpperCase(),o=void 0!==e.data?e.data:{},r=e.headers||{},l=function(){t({isError:!0})},p=void 0!==e.async?e.async:!0;if(XMLHttpRequest){if(i=new XMLHttpRequest,"withCredentials"in i){i.open(s,n,p),i.onerror=l,i.onreadystatechange=function(){4===i.readyState&&(i.status>=200&&400>i.status?t({data:i.responseText,status:i.status}):t({isError:!0,status:i.status}))};for(a in r)r.hasOwnProperty(a)&&i.setRequestHeader(a,r[a]);i.send(o)}}else if(XDomainRequest){i=new XDomainRequest,i.open(s,n),i.onerror=l,i.onload=function(){t(i.responseText)};for(a in r)r.hasOwnProperty(a)&&i.setRequestHeader(a,r[a]);i.send(o)}else t({isError:!0,message:"CORS not supported"})},A.log=function(){if(window.console&&window.console.log){var e=Array.prototype.slice.call(arguments);console.log.apply(console,e)}},A.addToken=function(e,t){return e&&(t.auth={token:e}),t},A.getServiceEndpoint=function(e){return"stg"===e?"https://api-stg.spilgames.com":"https://api.spilgames.com"},A.isWrapped=function(){return void 0!==(window.PhoneGap||window.cordova||window.Cordova)},A.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},A._getQueryString=function(){return window.location.search},A._getPortalHost=function(){return window&&window.location&&window.location.hostname?window.location.hostname:"unknown"},A.validateSchema=function(e,t){for(var i in t)if(t.hasOwnProperty(i)){if(!e.hasOwnProperty(i))return{error:"Wrong argument passed: "+i};if(e.hasOwnProperty(i)){var a="object"==typeof e[i]?e[i].type:e[i];if(t[i].constructor.name!==a)return{error:"Wrong value type for "+i+": expected "+e[i]+", got "+t[i].constructor.name};var n=e[i]&&e[i].values||[];if(-1===n.indexOf(t[i]))return{error:"Wrong value for "+i+": expected "+n.join(" or ")+", got "+t[i]}}}return{error:!1}};var b={};b.getGameConfig=function(e){var t=this;_.getGameConfig(function(i){i?e(i):e(t.getLocalConfig())})},b.getBrandingConfig=function(e,t){_.getBrandingConfig(e,t)},b.getLocalConfig=function(e){e=e&&Object.keys(e).length?e:{portal:{},game:{},branding:{},user:{},localization:{}};var t={isLocal:e.isLocal||!1,game:{applicationId:e.portal.applicationId||"0",contentarId:e.portal.contentarId||"0",info:e.game.info||{},settings:e.game.objectSettings||{},properties:e.game.properties||{},features:{achievements:e.game.achievements||!1,gameSidePanel:e.game.gameSidePanel||!1,highscores:e.game.highscores||!1,recommendedGames:e.game.recommendedGames||!1}},user:{authenticated:e.user.authenticated||!1,username:e.user.username||"",appToken:e.user.appToken||"",userId:e.user.userId||"",token:e.user.token||""},portal:{host:A._getPortalHost(),siteId:e.portal.siteId||0,channelId:e.portal.channelId||0,applicationId:e.portal.applicationId||"0",gamestate:e.portal.gamestate||!1,env:"stg"===e.portal.env?"stg":"prd",spilStorageId:e.portal.spilStorageId||""},branding:e.branding||{},localization:e.localization||{}};return t.branding.logo=t.branding.logo||{},t.branding.logo.url=t.branding.logo.url||!1,t.branding.logo.image=t.branding.logo.image||!1,t},b.configFromData=function(e){var t={game:{applicationId:e.id},user:{userId:e.userid?e.userid:void 0,appToken:e.appToken?e.appToken:void 0},portal:{applicationId:e.id,siteId:e.site?e.site:-1,channelId:e.channel?e.channel:100,gamestate:e.gamestate?e.gamestate:!1,env:"stg"===e.env?"stg":"prd",spilStorageId:e.spilStorageId}};return t},b.setupStandaloneMode=function(e,t){var i={},a={configar:{branding:{main:{label:"main",image:"http://www8.agame.com/mirror/img/logo_A10_202x50.png",url:"http://www.a10.com",style:"",width:"202",height:"50",mime:"image/png",type:"png",handler:"newTab",blacklisted:!0},logo:{label:"logo",image:"http://www8.agame.com/mirror/img/logo_A10_202x50.png",url:"http://www.a10.com",style:"",width:"202",height:"50",mime:"image/png",type:"png",handler:"newTab",blacklisted:!1},more_games:{label:"more_games",image:null,url:"http://www.a10.com",style:"",width:null,height:null,mime:null,type:null,handler:"newTab",blacklisted:!1},splash_screen:{label:"splash_screen",image:"place_holder_string",url:"http://www.a10.com",style:"",width:"0",height:"0",mime:"image/png",type:"png",handler:"newTab",blacklisted:!1}}}};i.JSLib={memory:{},_channels:{},get:function(e){return this.memory[e]?this.memory[e]:!1},set:function(e,t){return this.memory[e]=t,t},publish:function(e,t){this._channels[e]&&this._channels[e].forEach(function(e){try{e.fn.call(this,t)}catch(i){}})},subscribe:function(e,t){if("function"!=typeof t)throw Error("Callback has to be a function");if("string"!=typeof e)throw Error("Channel name has to be a string");this._channels[e]||(this._channels[e]=[]),this._channels[e].push({fn:t})}},i.Net={send:function(e,t){t.call(this,{})}},window.SpilGamesBootstrap=[],window.SpilGames=function(){var e=arguments;if(e[0]&&"string"==typeof e[0])i.JSLib.publish(e[0],e[1]||null);else if(e[0]&&e[0]instanceof Array){var t,a,n=[];for(t=0,a=e[0].length;a>t;t++)n.push(i[e[0][t]]);e[1].apply(this,n)}},e&&e.id?A.callConfigar(e,function(i,n){if(200===i&&"string"==typeof n&&JSON.parse(n)){var s=JSON.parse(n),o=b.configFromData(e);o.branding=s.configar&&s.configar.branding?s.configar.branding:a.configar.branding,t.call(this,o)}else t.call(this,{isLocal:!0,branding:a.configar.branding})}):t.call(this,{isLocal:!0,branding:a.configar.branding})},b.getCachedConfig=function(){},t.prototype.newTab=function(e){var t="_blank",i=e.url,a=window.open(i,t);return a&&a.focus(),a},t.prototype.moreGames=function(e){var t=e.brandName||"a10";e.isStandalone?this.newTab(e):e.messenger&&e.messenger.post&&e.messenger.post("game.moregames",{branding:t})},t.prototype.displayOnTop=function(e){if(e===void 0||e.url===void 0||"string"!=typeof e.url||e.action===void 0||"function"!=typeof e.action)return e.callback!==void 0||"function"==typeof e.callback?(e.callback(),void 0):void 0;var t=document.createElement("div"),i=e.url,a=e.action,n=e.callback;t.setAttribute("id","spilgames-splash-screen-sample"),document.body.appendChild(t);var s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return t.style.left="0",t.style.top="0",t.style.width=s+"px",t.style.height=o+"px",t.style.position="absolute",t.style.zIndex="10000",t.onclick=a,i&&(t.style.background="url('"+i+"') center center no-repeat #FFF"),window.setTimeout(function(){var e=document.getElementById("spilgames-splash-screen-sample");e.parentNode.removeChild(e),n&&n()},2e3),t},t.prototype.displayBanner=function(e){function t(){var e,t=document.createElement("fakeelement"),i={animation:"animationend",OAnimationend:"oanimationend",webkitAnimation:"webkitAnimationEnd"};for(e in i)if(void 0!==t.style[e])return i[e]}var i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a=i-90,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=e.image,o=e.action,r=e.eventTracking;n>640&&(n=640),r.trackGameAPIEvent("bannerShow",e.data);var l=document.createElement("style");l.type="text/css",l.innerHTML="@keyframes spil_crosspromotion_enter{from{visibility:visible;margin-top:"+i+"px;clip:rect(0px,"+n+"px,0px,0px);}10%{margin-top:"+a+"px;clip:rect(0px,"+n+"px,90px,0px);}80%{margin-top:"+a+"px;clip:rect(0px,"+n+"px,90px,0px);}to{visibility:hidden;margin-top:"+i+"px;clip:rect(0px,"+n+"px,0px,0px);}}@keyframes spil_crosspromotion_close{from{visibility:visible;margin-top:"+a+"px;clip:rect(0px,"+n+"px,90px,0px);}to{visibility:hidden;margin-top:"+i+"px;clip:rect(0px,"+n+"px,0px,0px);}}.spil_crosspromotion{visibility:hidden;pointer-events:all;width:"+n+"px;height:90px;margin:auto;margin-top:"+i+"px;position:relative;clip:rect(0px,"+n+'px,90px,0px);z-index:1;animation-name:spil_crosspromotion_enter;animation-duration:10s;animation-delay:2s;}.spil_crosspromotion div{background-image:url("'+s+'");background-repeat: no-repeat;background-color:#cccccc;margin:auto;height:90px;width:100%;}.spil_crosspromotion_closing{visibility:hidden;pointer-events:all;margin:auto;width:'+n+"px;height:90px;margin-top:"+a+'px;position:relative;z-index:1;animation-name:spil_crosspromotion_close;animation-duration:2s;}.spil_crosspromotion_closing div{background-image:url("'+s+'");background-repeat: no-repeat;background-color:#cccccc;margin:auto;height:90px;width:100%;}.spil_crosspromotion_closebtn{position:absolute;right:0;top:0px;}',document.getElementsByTagName("head")[0].appendChild(l);var p=document.createElement("div");p.style.position="fixed",p.style.zIndex="100",p.style.width="100%",p.style.height="100%",p.style.pointerEvents="none",p.innerHTML="<div id='spilgames_crosspromotion_banner'><div id='spil_banner_bg'></div><img id='closebanner' class='spil_crosspromotion_closebtn' src='http://files.cdn.spilcloud.com/gameapitest/1448551529_close.png'/></div>",document.body.insertBefore(p,document.body.childNodes[0]);var d=document.getElementById("spilgames_crosspromotion_banner");d.className="spil_crosspromotion",d.addEventListener(t(),function(){p.style.display="none"});var h=document.getElementById("spil_banner_bg");h.addEventListener("touchend",function(e){e.preventDefault(),e.target.click()}),h.addEventListener("click",function(){o(),r.trackGameAPIEvent("bannerClick",e.data)});var c=document.getElementById("closebanner");c.addEventListener("touchend",function(e){e.preventDefault(),e.target.click()}),c.addEventListener("click",function(){d.className="spil_crosspromotion_closing",r.trackGameAPIEvent("bannerClose",e.data)})},i.prototype.get=function(e){for(var t=this.dataStore,i=e.split("."),a=i.length,n=0;a-1>n;n++){if(!t[i[n]])return null;t=t[i[n]]}return t[i[a-1]]||null},i.prototype.put=function(e,t){for(var i=this.dataStore,a=e.split("."),n=a.length,s=0;n-1>s;s++){var o=a[s];i[o]||(i[o]={}),i=i[o]}i[a[n-1]]=t},i.prototype.set=function(e,t){this.put(e,t);var i=Date.parse(new Date);return this.notify({type:"new",key:e,current:t,previous:null,timestamp:i}),t},i.prototype.update=function(e,t){var i,a,n=null;return this.get(e)?(i="update",n=this.get(e)):i="new",this.put(e,t),a=Date.parse(new Date),this.notify({type:i,key:e,current:t,previous:n,timestamp:a}),t},i.prototype.remove=function(e){if(this.get(e)){var t,i=this.get(e);return this.put(e,null),t=Date.parse(new Date),this.notify({type:"remove",key:e,current:null,previous:i,timestamp:t}),!0}return!1},i.prototype._setCache=function(e){this.dataStore=e},i.prototype._getCache=function(){return this.dataStore},i.prototype.notify=function(e){if(this.IS_MASTER){var t=new f({type:"datachange",callbackId:null,data:e}).encode();return window.postMessage(t,"*"),t}},a.prototype.init=function(e){e=e||{},this.data=e.data||this.data,this.data&&this.data.game&&this.data.user&&(this.appId=this.data.game.applicationId||null,this.appToken=this.data.user.appToken||null,this.token=this.data.user.token||null),this._setupEvents(),this.appToken||this._getAppToken(),(this.IS_SLAVE||this.IS_STANDALONE||A.isWrapped())&&this._scheduleRefresh()},a.prototype.getAppToken=function(){return this.appToken},a.prototype._setupEvents=function(){this.IS_MASTER?this.messenger.subscribe("gameapi.apptoken.getAppToken",this._getAppToken,this):this.messenger.subscribe("gameapi.apptoken.getAppTokenResponse",this._getAppTokenResponse,this)},a.prototype._retryAppToken=function(e){(e||this.appTimerDelay!==this.appDelayMax)&&(e&&!this.appError&&(this.appTimerDelay=this.appDelayMin,this.appError=!0),this._unschedule(),e?this._increaseDelay():this._resetDelay(),this._scheduleRefresh())},a.prototype._scheduleRefresh=function(){var e=this;null===this.appTimer&&(this.appTimer=setInterval(function(){e._getAppToken()},this.appTimerDelay))},a.prototype._unschedule=function(){this.appTimer&&clearTimeout(this.appTimer),this.appTimer=null},a.prototype._increaseDelay=function(){this.appTimerDelay=Math.min(2*this.appTimerDelay,this.appDelayMax)},a.prototype._resetDelay=function(){this.appTimerDelay=this.appDelayMax},a.prototype._getAppToken=function(){var e=this.messenger,t=this;if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");this.IS_MASTER||this.messenger._postMessage({},void 0,"gameapi.apptoken.getAppToken"),this.IS_MASTER&&("function"==typeof SpilGames?SpilGames("api.account.getApplicationToken",A.addToken(this.token,{cache:!1,applicationId:this.appId}),function(i){i.error||!i.appAuth.token?e._postMessage({},void 0,"gameapi.apptoken.getAppTokenResponse"):(t.appToken=i.appAuth.token,e._postMessage({appToken:i.appAuth.token,level:i.level},void 0,"gameapi.apptoken.getAppTokenResponse"))}):e._postMessage({},void 0,"gameapi.apptoken.getAppTokenResponse"))},a.prototype._getAppTokenResponse=function(e){e.appToken?(this.appToken=e.appToken,this._retryAppToken(!1)):this._retryAppToken(!0)},n.prototype.init=function(e){e=e||{},this.data=e.data||this.data,this.data&&this.data.game&&this.data.user&&this.data.portal&&(this.gameState.appId=this.data.game.applicationId||null,this.gameState.userId=this.data.user.userId||null,this.isGamestate=this.data.portal.gamestate||!1,this.endpoint=A.getServiceEndpoint(this.data.portal.env),this.spilStorageId=this.data.portal.spilStorageId),this.isGamestate&&(this.IS_SLAVE||this.IS_STANDALONE||A.isWrapped())&&(this.listenStorageEvents(),this.preloadGameState())},n.prototype.listenStorageEvents=function(){var e=function(e){this.onStorageEvent(e)}.bind(this);window.addEventListener("storage",e,!1)},n.prototype.flagDirtyKey=function(e){-1===this.gameState.dirtyKeys.indexOf(e)&&(this.gameState.dirtyKeys.push(e),this.scheduleSyncState())},n.prototype.unschedule=function(){this.flushTimer&&clearTimeout(this.flushTimer),this.flushTimer=null},n.prototype.scheduleSyncState=function(){var e=this;null===this.flushTimer&&(this.flushTimer=setInterval(function(){e.syncState()},this.flushTimerDelay))},n.prototype.increaseDelaySyncState=function(){this.flushTimerDelay=Math.min(2*this.flushTimerDelay,this.flushDelayMax)},n.prototype.resetDelaySyncState=function(){this.flushTimerDelay=this.flushDelayMin},n.prototype.onStorageEvent=function(e){e&&e.url&&e.url.indexOf("spilStorageId="+this.spilStorageId)>0&&this.flagDirtyKey(e.key)},n.prototype.preloadGameState=function(){var e={url:this.endpoint+"/v1/gamestate/"+this.gameState.userId+"/"+this.gameState.appId,type:"GET",dataType:"JSON",headers:{"x-auth-token":this.appToken.getAppToken()}};A.xdr(e,function(e){if(e.isError)A.log("GameAPIGameState failed preloading: "+e.status);else{var t=JSON.parse(e.data);if(t&&t.gamestate){var i=t.gamestate,a=0,n=null;for(n in i)i.hasOwnProperty(n)&&(window.localStorage[n]=i[n],a++);A.log("GameAPIGameState preloaded: "+a+" keys")}}})},n.prototype.retrySyncState=function(e){A.log(e),this.increaseDelaySyncState(),this.scheduleSyncState()},n.prototype.syncState=function(){if(this.unschedule(),!this.gameState.appId)return this.retrySyncState("GameAPIGameState.prototype.syncStat no appId");if(!this.gameState.userId)return this.retrySyncState("GameAPIGameState.prototype.syncState no userId");for(var e,t=this.gameState.appId,i=this.gameState.userId,a=this.gameState.dirtyKeys,n={set:{},remove:[]},s=0,o=this,r=0;a.length>r;r++)e=window.localStorage[a[r]],void 0===e?n.remove.push(a[r]):(n.set[a[r]]=e,s=Math.max(e.length,s));if(a.length>0){var l={url:this.endpoint+"/v1/gamestate/"+i+"/"+t,type:"POST",data:JSON.stringify(n),async:!0,headers:{"x-auth-token":this.appToken.getAppToken()}};A.xdr(l,function(e){e.isError?o.retrySyncState("GameAPIGameState error syncing state"):(A.log("GameAPIGameState synced "+a.length+" keys"),o.resetDelaySyncState(),o.gameState.dirtyKeys=[])});var p={numkeys:a.length,maxdatalength:s,userid:i};this.eventTracking.trackGameAPIEvent("gameState",p)}return!0},s.prototype.init=function(e){this.data=e.data||null},s.prototype._performAction=function(e){var t=new f(e.data||{}),i=this.messenger,a=this.subscribers||{};if(t&&t.type&&t.data)switch(t.type){case"gameEvent":t.data[0]&&a[t.data[0]]&&a[t.data[0]].length>0?a[t.data[0]].forEach(function(e){e.call(this),i._postMessage([t.data[0],{origin:"slave"},null],null,"gameState")}):t.data[0]&&t.data[1]&&"slave"===t.data[1].origin&&"function"==typeof SWFtoJS&&SWFtoJS({call:t.data[0],params:{}});break;case"gameState":t.data[0]&&t.data[1]&&"slave"===t.data[1].origin&&(this.gameState=t.data[0])}},s.prototype.on=function(e,t){this.IS_SLAVE&&(this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push(t))},s.prototype.emit=function(e){if(!this.IS_MASTER)throw Error("Only the master environment can emit game events");if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");if(e===this.gameState)throw Error("The game is already in state: `"+e+"`");this.messenger._postMessage([e,{origin:"master"},null],null,"gameEvent")},s.prototype.isSiteLock=function(){var e=!0;if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");return this.data&&this.data.portal&&this.data.portal.siteId&&500>this.data.portal.siteId&&(e=!1),e},s.prototype.adjustHeight=function(e){if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");this.IS_MASTER?"function"==typeof SpilGames&&SpilGames.Events!==void 0&&"function"==typeof SpilGames.Events.publish&&SpilGames.Events.publish("portal.adjustheight",{height:e,onsuccess:function(){}}):(this.messenger._postMessage(e,void 0,"gameapi.game.adjustHeight"),this.messenger._postMessage(["log.gameapi.game.adjustHeight",{origin:"slave",height:e},null],null,"log"))},o.prototype.init=function(e){e=e||{},this.data=e.data||this.data,this._setupEvents()},o.prototype._setupEvents=function(){this.isMaster||this.messenger.subscribe("gameapi.locale.change",this._localeChange,this)},o.prototype._localeChange=function(e){this.activeLanguage=e},o.prototype.changeLocale=function(e){this.isMaster&&this.messenger._postMessage(e,void 0,"gameapi.locale.change")},o.prototype.getLocalizedText=function(e,t){if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");var i=e;return this.data&&this.data.localization[this.activeLanguage]&&this.data.localization[this.activeLanguage][e]&&this.data.localization[this.activeLanguage][e].id&&this.data.localization[this.activeLanguage][e].id===t&&(i=this.data.localization[this.activeLanguage][e].text),i},r.prototype.init=function(e){this._setLocale(e),this._setupEvents(),e&&e.data&&e.data.portal&&e.data.portal.siteId&&500>e.data.portal.siteId&&"0"!==e.data.portal.siteId&&(this.isAvailable=!0)},r.prototype._setupEvents=function(){this.IS_MASTER?(this.messenger.subscribe("gameapi.user.forceAuthentication",this.forceAuthentication,this),this.messenger.subscribe("gameapi.user.getUser",this.getUser,this),this.messenger.subscribe("gameapi.user.login",this.login,this)):(this.messenger.subscribe("gameapi.user.loginResponse",this._loginResponse,this),this.messenger.subscribe("gameapi.user.getUserResponse",this._getUserResponse,this))},r.prototype.login=function(e,t){var i=this.messenger;if(e=e||{},this.logincallback=t,this.IS_MASTER)SpilGames("api.auth.getToken",{context:{channelid:100,siteid:2}},function(t){SpilGames("api.auth.login",{auth:{token:t.auth.token},login:e.username,password:e.password},function(e){i._postMessage(e,void 0,"gameapi.user.loginResponse")})});else{var a={};a.username=e.username||"",a.password=e.password||"",i._postMessage(a,void 0,"gameapi.user.login")}},r.prototype._loginResponse=function(e){var t={};t.success=!1,e.auth&&e.auth.token&&(this.loggedIn=!0,this.token=e.auth.token,t.success=!0),this.logincallback(t),this.logincallback=function(){}},r.prototype.forceAuthentication=function(){if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");this.IS_MASTER?"function"==typeof SpilGames&&SpilGames.Portal!==void 0&&"function"==typeof SpilGames.Portal.forceAuthentication&&SpilGames.Portal.forceAuthentication({onsuccess:function(){}}):(this.messenger._postMessage({},void 0,"gameapi.user.forceAuthentication"),this.messenger._postMessage(["log.gameapi.user.forceAuthentication",{origin:"slave"},null],null,"log"))},r.prototype.getUser=function(e){var t=this.messenger;if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");if(this.IS_MASTER)"function"==typeof SpilGames?this.isAvailable?SpilGames(["JSLib"],function(e){e&&"function"==typeof e?e("api.user.getExtended",function(e){t._postMessage(e,void 0,"gameapi.user.getUserResponse")
}):t._postMessage({userInfoExtended:{}},void 0,"gameapi.user.getUserResponse")}):this.loggedIn?SpilGames("api.user.getExtended",{auth:{token:this.token},context:{channelid:100,siteid:2}},function(e){t._postMessage(e,void 0,"gameapi.user.getUserResponse")}):t._postMessage({userInfoExtended:{}},void 0,"gameapi.user.getUserResponse"):t._postMessage({userInfoExtended:{}},void 0,"gameapi.user.getUserResponse");else{if("function"!=typeof e)throw Error("The argument passed to the GameAPI.User.getUser method should be a function");this.usercallback=e,t._postMessage({},void 0,"gameapi.user.getUser"),t._postMessage(["log.gameapi.user.getUser",{origin:"slave",argumentType:typeof e},null],null,"log")}},r.prototype._getUserResponse=function(e){var t=e.userInfoExtended||{},i=this._validateData(t),a=!1;""===t.guid&&(a=!0),this.eventTracking.trackGameAPIEvent("userGet",{guid:i.guid||"",fail:a}),this.usercallback(i)},r.prototype._validateData=function(e){var t={uid:e.uid||"",guid:e.guid||"",displayName:e.name||"",pic_square:e.avatarUrl||"",pic_square_large:e.avatarLargeUrl||"",gender:e.gender||"",age:e.age||"",birthday:e.birthdate||"",level:e.level||"",locale:this.locale||""};return t},r.prototype._setLocale=function(e){e&&e.data&&e.data.portal&&e.data.portal.siteId&&(this.locale=this._getLang(e.data.portal.siteId))},r.prototype._getLang=function(e){for(var t=[{siteid:1,lang:"nl-NL"},{siteid:2,lang:"en-US"},{siteid:5,lang:"de-DE"},{siteid:11,lang:"fr-FR"},{siteid:12,lang:"fr-FR"},{siteid:15,lang:"it-IT"},{siteid:16,lang:"pl-PL"},{siteid:24,lang:"en-US"},{siteid:25,lang:"nl-NL"},{siteid:26,lang:"de-DE"},{siteid:44,lang:"sv-SE"},{siteid:50,lang:"pt-BR"},{siteid:55,lang:"en-ID"},{siteid:79,lang:"en-US"},{siteid:86,lang:"es-ES"},{siteid:87,lang:"pt-BR"},{siteid:88,lang:"en-US"},{siteid:90,lang:"en-US"},{siteid:91,lang:"pt-BR"},{siteid:92,lang:"en-GB"},{siteid:93,lang:"nl-NL"},{siteid:94,lang:"de-DE"},{siteid:95,lang:"fr-FR"},{siteid:96,lang:"es-ES"},{siteid:97,lang:"es-ES"},{siteid:98,lang:"pl-PL"},{siteid:99,lang:"it-IT"},{siteid:100,lang:"sv-SE"},{siteid:101,lang:"pt-BR"},{siteid:102,lang:"en-GB"},{siteid:103,lang:"ru-RU"},{siteid:104,lang:"ru-RU"},{siteid:105,lang:"ru-RU"},{siteid:106,lang:"it-IT"},{siteid:107,lang:"en-GB"},{siteid:108,lang:"sv-SE"},{siteid:109,lang:"pl-PL"},{siteid:115,lang:"en-GB"},{siteid:116,lang:"tr-TR"},{siteid:118,lang:"ms-MY"},{siteid:119,lang:"en-GB"},{siteid:120,lang:"jp-JP"},{siteid:121,lang:"en-US"},{siteid:122,lang:"es-ES"},{siteid:123,lang:"en-US"},{siteid:124,lang:"en-US"},{siteid:125,lang:"AR"},{siteid:126,lang:"en-US"},{siteid:127,lang:"en-US"},{siteid:128,lang:"nl-NL"},{siteid:129,lang:"es-AR"},{siteid:130,lang:"es-MX"},{siteid:131,lang:"de-DE"},{siteid:132,lang:"en-EN"},{siteid:133,lang:"en-EN"},{siteid:134,lang:"en-ID"},{siteid:135,lang:"de-DE"},{siteid:136,lang:"pl-PL"},{siteid:137,lang:"en-EN"},{siteid:138,lang:"it-IT"},{siteid:139,lang:"uk-UA"},{siteid:140,lang:"en-ID"},{siteid:141,lang:"uk-UA"},{siteid:142,lang:"ja-JP"},{siteid:143,lang:"nl-NL"},{siteid:144,lang:"en-US"},{siteid:145,lang:"en-US"},{siteid:146,lang:"en-US"},{siteid:147,lang:"en-US"},{siteid:148,lang:"en-US"},{siteid:149,lang:"en-IN"},{siteid:150,lang:"tr-TR"},{siteid:151,lang:"de-DE"},{siteid:152,lang:"ru-RU"},{siteid:153,lang:"ru-RU"},{siteid:154,lang:"ru-RU"},{siteid:155,lang:"en-US"},{siteid:156,lang:"tr-TR"},{siteid:157,lang:"tr-TR"},{siteid:158,lang:"tr-TR"},{siteid:159,lang:"en-US"},{siteid:160,lang:"en-US"},{siteid:161,lang:"en-US"},{siteid:162,lang:"en-US"},{siteid:163,lang:"en-US"},{siteid:164,lang:"en-US"},{siteid:165,lang:"en-US"},{siteid:166,lang:"en-US"},{siteid:167,lang:"en-US"},{siteid:168,lang:"en-US"},{siteid:169,lang:"en-US"},{siteid:170,lang:"en-US"},{siteid:171,lang:"en-US"},{siteid:172,lang:"en-US"},{siteid:173,lang:"en-US"},{siteid:174,lang:"en-US"},{siteid:175,lang:"en-US"},{siteid:176,lang:"en-US"},{siteid:177,lang:"en-US"},{siteid:178,lang:"en-US"},{siteid:179,lang:"en-US"},{siteid:180,lang:"en-UK"},{siteid:181,lang:"nl-NL"},{siteid:182,lang:"fr-FR"},{siteid:183,lang:"de-DE"},{siteid:184,lang:"en-US"},{siteid:185,lang:"en-US"},{siteid:186,lang:"en-EN"},{siteid:187,lang:"en-EN"},{siteid:188,lang:"en-EN"},{siteid:189,lang:"en-EN"},{siteid:190,lang:"en-EN"},{siteid:191,lang:"en-US"},{siteid:192,lang:"pt-BR"},{siteid:193,lang:"en-US"},{siteid:450,lang:"en-US"},{siteid:451,lang:"nl-NL"},{siteid:452,lang:"de-DE"},{siteid:453,lang:"fr-FR"},{siteid:454,lang:"es-ES"},{siteid:455,lang:"it-IT"},{siteid:456,lang:"en-GB"},{siteid:457,lang:"en-ID"},{siteid:458,lang:"es-AR"},{siteid:459,lang:"es-LA"},{siteid:460,lang:"es-MX"},{siteid:461,lang:"jp-JP"},{siteid:462,lang:"ms-MY"},{siteid:463,lang:"pl-PL"},{siteid:464,lang:"pt-BR"},{siteid:465,lang:"pt-PT"},{siteid:466,lang:"ru-RU"},{siteid:467,lang:"sv-SE"},{siteid:468,lang:"tr-TR"}],i=0;t.length>i;i++)if(t[i].siteid===e)return t[i].lang;return""},l.prototype.init=function(e){this._setupEvents(),e&&e.data&&e.data.portal&&e.data.portal.siteId&&500>e.data.portal.siteId&&"0"!==e.data.portal.siteId&&(this.isAvailable=!0)},l.prototype._setupEvents=function(){this.IS_MASTER?(this.messenger.subscribe("gameapi.friends.showInvite",this.showInvite,this),this.messenger.subscribe("gameapi.friends.getFriends",this.getFriends,this)):this.messenger.subscribe("gameapi.friends.getFriendsResponse",this._getFriendsResponse,this)},l.prototype.showInvite=function(){if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");this.IS_MASTER?"function"==typeof SpilGames&&SpilGames.Events!==void 0&&"function"==typeof SpilGames.Events.publish&&SpilGames.Events.publish("invitefriends.request"):(this.messenger._postMessage({},void 0,"gameapi.friends.showInvite"),this.messenger._postMessage(["log.gameapi.friends.showInvite",{origin:"slave"},null],null,"log"),this.eventTracking.trackGameAPIEvent("friendsInvite",{guid:this.guid||""}))},l.prototype.getFriends=function(e){var t=this.messenger;if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");if(this.IS_MASTER){if("function"==typeof SpilGames){var i=this;SpilGames(["JSLib"],function(e){e&&"function"==typeof e?e("api.user.getExtended",function(e){e.userInfoExtended&&"guest"!==e.userInfoExtended.name&&e.userInfoExtended.guid?(this.userGuid=e.userInfoExtended.guid,i._getFriendsFromPortal([],1)):t._postMessage({friendList:{}},void 0,"gameapi.friends.getFriendsResponse")}):t._postMessage({friendList:{}},void 0,"gameapi.friends.getFriendsResponse")})}}else"function"==typeof e&&(this.friendscallback=e),t._postMessage({},void 0,"gameapi.friends.getFriends"),t._postMessage(["log.gameapi.friends.getFriends",{origin:"slave"},null],null,"log")},l.prototype._getFriendsFromPortal=function(e,t){var i=this.messenger,a=e;if("function"==typeof SpilGames){var n=this;SpilGames("api.friend.list",{guid:this.userGuid,pageControl:{page:t,pageSize:500}},function(e){e.error?i._postMessage(a,void 0,"gameapi.friends.getFriendsResponse"):(a=a.concat(e.friendList),e.pageControl&&e.pageControl.totalPages>t?n._getFriendsFromPortal(a,t+1):i._postMessage({friendList:a},void 0,"gameapi.friends.getFriendsResponse"))})}else i._postMessage({friendList:e},void 0,"gameapi.friends.getFriendsResponse")},l.prototype._getFriendsResponse=function(e){var t=this._validateData(e.friendList),i=!1;0===t.length&&(i=!0),this.eventTracking.trackGameAPIEvent("friendsGet",{guid:this.guid||"",fail:i}),this.friendscallback(t)},l.prototype._validateData=function(e){for(var t=[],i=0;e.length>i;i++){var a={uid:e[i].uid||"",guid:e[i].guid||"",displayName:e[i].name||"",pic_square:e[i].avatarUrl||"",pic_square_large:e[i].avatarLargeUrl||"",gender:e[i].gender||"",age:e[i].age||""};t.push(a)}return t},p.prototype.init=function(e){e=e||{},this.data=e.data||this.data,this.data&&this.data.user&&(this.state.userId=this.data.user.userId||null)},p.prototype._setupMasterEvent=function(){this.IS_MASTER&&this.messenger.subscribe("gameapi.score",this.submit,this)},p.prototype._obfuscateScore=function(e){var t=2166136261,i=e.length,a=0;if(!i)return t;for(;i>a;++a)t^=e.charCodeAt(a),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0},p.prototype.submit=function(e){if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");if(this.IS_MASTER){var t=!1,i=window.outerHeight-window.innerHeight,a="";this.appToken&&(a=this.appToken.getAppToken()),i===this.initialHeight&&(t=!0),this.eventTracking.trackGameAPIEvent("scoreSubmit",{score:e,initialheight:this.initialHeight,submitheight:i,equals:t,os:this._obfuscateScore(""+e),guid:this.state.userId,apptoken:a}),"function"==typeof SWFtoJS&&SWFtoJS({call:"UPDATE_HIGHSCORE",params:{score:e}})}else this.messenger._postMessage(e,void 0,"gameapi.score"),this.messenger._postMessage(["log.gameapi.score.submit",{origin:"slave",score:e},null],null,"log");return{success:!0,value:e}},d.prototype.init=function(e){e=e||{},this.data=e.data||this.data,this.data&&this.data.user&&(this.state.userId=this.data.user.userId||null)},d.prototype._setupMasterEvent=function(){this.IS_MASTER&&this.messenger.subscribe("gameapi.award",this.submit,this)},d.prototype.submit=function(e){var t=e.award||"";if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");if(this.IS_MASTER){var i=!1,a="";this.appToken&&(a=this.appToken.getAppToken()),window.outerHeight-window.innerHeight===this.initialHeight&&(i=!0),this.eventTracking.trackGameAPIEvent("awardSubmit",{award:t,initialheight:this.initialHeight,submitheight:window.outerHeight-window.innerHeight,equals:i,guid:this.state.userId,apptoken:a})}else this.messenger._postMessage(e,void 0,"gameapi.award"),this.messenger._postMessage(["log.gameapi.award.submit",{origin:"slave",award:t},null],null,"log");return{success:!0,value:e.award}},h.prototype.init=function(e){e=e||{},this.data=e.data||this.data},h.prototype._setupMasterEvent=function(){var e=this.IS_MASTER?this._masterHandler:this._slaveHandler;this.messenger.subscribe("gameapi.secondscreen",e,this)},h.prototype._masterHandler=function(e){window.SpilGames&&SpilGames(["SWPEvent"],function(t){t.emit("system.game.secondscreen",e)})},h.prototype._slaveHandler=function(e){e.event&&this._handleClientEvent(e.event)},h.prototype._dispatchEvent=function(e){var t=document.createEvent("Event");t.initEvent(e.name,!0,!0);for(var i in e.properties)e.properties.hasOwnProperty(i)&&(t[i]=e.properties[i]);document.body.dispatchEvent(t)},h.prototype._handleClientEvent=function(e){var t=this.data.mapping;if(t[e.id]&&t[e.id][e.type]){var i=t[e.id][e.type];i.properties||(i.properties={}),i.function&&(i=i.function(i)),i&&i.name&&this._dispatchEvent(i)}},h.prototype.relayClientEvents=function(e){this.IS_MASTER&&this.messenger._postMessage({event:e},void 0,"gameapi.secondscreen")},h.prototype.updateControls=function(e,t){this.IS_MASTER||(this.data.mapping=t||{},this.messenger._postMessage({controls:e},void 0,"gameapi.secondscreen"))},c.prototype.init=function(e){e=e||{},this.data=e.data||this.data,this._setupEvents(),this.messenger._postMessage(!0,void 0,"gameapi.gamebreak.checkavailable")},c.prototype._setupEvents=function(){if(this.isMaster){var e=this;SpilGames(["JSLib"],function(t){e._setupJSLibGameBreakFlow(t,"ad.request.accepted","game.ad.accepted"),e._setupJSLibGameBreakFlow(t,"adreward.request.accepted","game.adreward.accepted"),t.subscribe("ad.complete",function(){e.messenger._postMessage(void 0,void 0,"ad.complete")})}),this.messenger.subscribe("gameapi.ad.request",this._setupAd,this),this.messenger.subscribe("game.ad.request",this._triggerAd,this),this.messenger.subscribe("gameapi.adreward.request",this._setupAd,this),this.messenger.subscribe("gameapi.adreward.request",this._triggerAdreward,this),this.messenger.subscribe("game.force.break",this._forceGamebreak,this),this.messenger.subscribe("gameapi.gamebreak.checkavailable",this._checkAvailable,this)}else this.messenger.subscribe("ad.request.accepted",this._onAdAccepted,this),this.messenger.subscribe("adreward.request.accepted",this._onRewardAccepted,this),this.messenger.subscribe("ad.complete",this._onAdCompleted,this),this.messenger.subscribe("gameapi.gamebreak.checkavailableresponse",this._checkAvailableResponse,this)},c.prototype._setupJSLibGameBreakFlow=function(e,t,i){var a=this;e.subscribe(t,function(e){!0===e&&a.adRequested&&(a.adRequested=!1,SpilGames(i,!0),a.messenger._postMessage(!0,void 0,t))})},c.prototype._setupAd=function(){this.adRequested=!0},c.prototype._checkAvailable=function(){this.isMaster&&AdConfig.getPosition("sgAdOgGp300x250")!==void 0?this.messenger._postMessage(!0,void 0,"gameapi.gamebreak.checkavailableresponse"):this.messenger._postMessage(!1,void 0,"gameapi.gamebreak.checkavailableresponse")},c.prototype._checkAvailableResponse=function(e){this.isMaster||this.isStandalone||(this.adAvailable=e)},c.prototype._triggerAd=function(){SpilGames("game.ad.request")},c.prototype._triggerAdreward=function(){SpilGames("game.adreward.request")},c.prototype._forceGamebreak=function(){SpilGames("game.ad.accepted",!0)},c.prototype._runCallback=function(e){this._callbacks[e]&&(this._callbacks[e](),this._callbacks[e]=!1)},c.prototype.isAvailable=function(){var e=!1;return this.adAvailable&&this.data&&this.data.portal&&this.data.portal.siteId&&187!==this.data.portal.siteId&&500>this.data.portal.siteId&&(e=!0),e},c.prototype.reward=function(e,t){var i=this;if("function"!=typeof e)throw Error("pauseGame argument should be a function");if("function"!=typeof t)throw Error("resumeGame argument should be a function");if(!i.moduleReady)throw Error("This method cannot be called before the API is loaded");return i._callbacks.pause=e,i._callbacks.resume=t,this.isMaster?(i._runCallback("resume"),void 0):(i.messenger._postMessage(void 0,void 0,"gameapi.adreward.request"),i.messenger._postMessage(["log.gameapi.adreward.requested",{origin:"slave"},null],null,"log"),this.messenger._postMessage(void 0,void 0,"game.ad.request"),this.timeout=setTimeout(function(){i._requestTimeout()},this.timeoutAfter),void 0)},c.prototype.request=function(e,t){var i=this;if("function"!=typeof e)throw Error("pauseGame argument should be a function");if("function"!=typeof t)throw Error("resumeGame argument should be a function");if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");this._callbacks.pause=e,this._callbacks.resume=t,this.isMaster||(this.messenger._postMessage(void 0,void 0,"gameapi.ad.request"),this.messenger._postMessage(["log.gameapi.ad.requested",{origin:"slave"},null],null,"log")),this.messenger._postMessage(void 0,void 0,"game.ad.request"),this.timeout=setTimeout(function(){i._requestTimeout()},this.timeoutAfter)},c.prototype._onAdAccepted=function(e){var t=this.messenger;this.timeout&&clearTimeout(this.timeout),!this.isMaster&&e&&(t._postMessage(["log.gameapi.ad.start",{origin:"slave"},null],null,"log"),this._runCallback("pause"))},c.prototype._onRewardAccepted=function(e){var t=this.messenger;this.timeout&&clearTimeout(this.timeout),!this.isMaster&&e&&(t._postMessage(["log.gameapi.adreward.start",{origin:"slave"},null],null,"log"),this._runCallback("pause"))},c.prototype._onAdCompleted=function(){var e=this.messenger;this.isMaster||e._postMessage(["log.gameapi.ad.complete",{origin:"slave"},null],null,"log"),this._runCallback("resume")},c.prototype._requestTimeout=function(){this._onAdCompleted()},g.prototype._setupEvents=function(){this.IS_MASTER&&this.messenger.subscribe("gameapi.gameevent",this.emit,this)},g.prototype._validateEvent=function(e){var t=!1;return this.events[e]&&this.events[e]!==void 0&&(t=!0),t},g.prototype.emit=function(e){if(!this.moduleReady)throw Error("This method cannot be called before the API is loaded");this._validateEvent(e)?this.IS_MASTER?"function"==typeof SWFtoJS&&SWFtoJS({call:e}):(this.messenger._postMessage(e,void 0,"gameapi.gameevent"),this.messenger._postMessage(["log.gameapi.gameevent.emit",{origin:"slave",evt:e},null],null,"log")):this.IS_MASTER||this.messenger._postMessage(["log.gameapi.gameevent.emit",{origin:"slave"},null],null,"log")},u.prototype.init=function(e){e=e||{},this.data=e.data||this.data;var t=this.data&&this.data.game&&this.data.game.applicationId?this.data.game.applicationId:null,i=new Date,a=window.location.hostname;this.data&&this.data.portal?(this.isGamestate=this.data.portal.gamestate||!1,this.siteId=this.data.portal.siteId?this.data.portal.siteId:null,this.channelId=this.data.portal.channelId?this.data.portal.channelId:null):(this.siteId=null,this.channelId=null),this.configureInternalTracking(t,i,a),this.isGamestate||(this.IS_SLAVE||this.IS_STANDALONE||A.isWrapped())&&this.startInternalTracking()},u.prototype._createEventObject=function(e,t,i){return{eventCategory:e,eventAction:t,properties:i}},u.prototype._sendSETEvent=function(e,t,i){return this.IS_STANDALONE?A.submitData("http://logs.spilgames.com/lg/pb/1/ut/",t,i):this.messenger&&this.messenger.post("tracker.event."+e,t,i),t},u.prototype.trackGamePlay=function(e){if(!this.gamePlayTracking.started)return!1;var t=this.gamePlayTracking.appid,i=this.gamePlayTracking.timestamp,a=this.gamePlayTracking.host,n=this._createEventObject("game","gameplay",{applicationId:t,start:i,host:a}),s=this.data.isLocal,o=!0,r=0,l=0;this.siteId&&(r=parseInt(this.siteId,10)),this.channelId&&(l=parseInt(this.channelId,10)),this.data&&this.data.branding&&this.data.branding.logo&&this.data.branding.logo.image&&(o=!1);var p=this._createEventObject("gameapi","load",{siteid:r,appid:t,channelid:l,domainname:a,isstandalone:this.IS_STANDALONE,isfallbackconfig:s,iswhitelisted:o});return this._sendSETEvent("express",n,e),this._sendSETEvent("express",p,function(){}),n},u.prototype.trackTimeInGame=function(e){if(!this.timeInGameTracking.started)return!1;var t=this.timeInGameTracking.appid,i=this.timeInGameTracking.timestamp,a=this._createEventObject("game","heartbeat",{applicationId:t,start:i});return this._sendSETEvent("express",a,e),a},u.prototype.trackGameAPIEvent=function(e,t){t.appid=this.gamePlayTracking.appid,t.domainname=this.gamePlayTracking.host,t.siteid=parseInt(this.siteId,10),t.channelid=parseInt(this.channelId,10);var i=this._createEventObject("gameapi",e,t);this._sendSETEvent("express",i,function(){})},u.prototype.configureInternalTracking=function(e,t,i){return e?(this.gamePlayTracking.appid=e,this.gamePlayTracking.timestamp=Date.parse(t),this.gamePlayTracking.host=i,this.timeInGameTracking.appid=e,this.timeInGameTracking.timestamp=Date.parse(t),void 0):{error:"No application ID defined for this game"}},u.prototype.startInternalTracking=function(){var e=this,t=6e4,i=function(e){if(!e)throw"Could not save the time in game"};return this.moduleReady?this.gamePlayTracking.appid?(this.gamePlayTracking.started=!0,this.timeInGameTracking.started=!0,this.trackGamePlay(function(e){if(!e)throw"Could not save the game play"}),this.trackTimeInGame(i),setInterval(function(){e.trackTimeInGame(i)},t),this.gamePlayTracking.started&&this.timeInGameTracking.started):{error:"No application ID defined for this game"}:{error:"This method cannot be called before the API is loaded"}},m.prototype.init=function(e){var t;e=e||{},this.data=e.data||this.data,this.data&&this.data.portal&&this.data.portal.siteId&&(t=this.data.portal.siteId,(t>499||12===t||25===t||26===t||55===t||79===t||97===t||105===t||108===t||138===t||157===t||121===t||1===t||5===t||11===t||15===t||16===t||44===t||50===t||87===t||86===t||88===t||92===t||103===t||140===t||90===t||93===t||95===t||94===t||96===t||98===t||99===t||100===t||101===t||102===t||104===t||134===t)&&this.data.branding&&this.data.branding.more_games&&this.data.branding.more_games.handler&&"moreGames"!==this.data.branding.more_games.handler&&(this.data.branding.more_games.handler="moreGames")),this.data&&this.data.portal&&this.data.portal.siteId?this.data.portal.siteId>=500||-1===this.data.portal.siteId?(this.IS_SLAVE||this.IS_STANDALONE)&&this._displaySpilBanner({onportal:!1}):(this.IS_SLAVE||this.IS_STANDALONE)&&this._displaySpilBanner({onportal:!0}):(this.IS_SLAVE||this.IS_STANDALONE)&&this._displaySpilBanner({onportal:!1})},m.prototype.getLogo=function(e){if(!this.moduleReady)return{error:"This method cannot be called before the API is loaded"};var t=this.IS_MASTER?"master":"slave";this.messenger._postMessage(["log.branding.getlogo",{origin:t},null],null,"log");var i,a,n={type:{type:"String",values:["png"]},width:"Number",height:"Number"};return i=this._getLink("logo"),e&&"object"==typeof e&&(a=A.validateSchema(n,e),a.error&&(i.error=a.error)),i},m.prototype.getLink=function(e){if(!e)return{error:"No link identifier provided"};var t=this.listLinks();if(-1!==t.indexOf(e)){var i=this.IS_MASTER?"master":"slave";return this.messenger._postMessage(["log.branding.getlink",{origin:i,linkName:e},null],null,"log"),this._getLink(e)}return{error:"Invalid option: '"+e+"'",action:function(){}}},m.prototype._getLink=function(e){if(!e)return{error:"No link identifier provided"};var t=this.data&&this.data.branding?this.data.branding:{};return t&&t[e]?{linkName:e,image:t[e].image||!1,action:this._executeHandler.bind(this,e)}:{error:"Invalid option: '"+e+"'",action:function(){}}},m.prototype._getGMLink=function(e){var t=null;if(!e)return{error:"No link identifier provided"};var i=this.data&&this.data.branding?this.data.branding:{};return i&&i[e]?(t=this._tagUrl(i[e].url,e),{linkName:e,url:t}):{error:"Invalid option: '"+e+"'",url:null}},m.prototype.getLinks=function(){var e={},t=this.listLinks();if(0===t.length)e={more_games:{action:function(){}}};else for(var i=0;t.length>i;i++){var a=t[i];e[a]=this._getLink(a)}return e},m.prototype._executeHandler=function(e){var t=this.data&&this.data.branding?this.data.branding:{},i=t[e],a=i.handler,n=this._tagUrl(i.url,e),s=this._getBrandName(t);if(i.url&&i.url.length>0&&a&&this.components[a]){var o=this.IS_MASTER?"master":"slave";return this.messenger._postMessage(["log.branding.linkAction",{origin:o,linkName:e},null],null,"log"),this.components[a]({url:n,messenger:this.messenger,isStandalone:this.IS_STANDALONE,brandName:s})}return function(){}},m.prototype._getBrandName=function(e){var t="a10";if(e&&e.more_games&&e.more_games.url){var i=e.more_games.url;t=i.replace(/(.*)www./,"").replace(/\..*/,"")}return t},m.prototype.listLinks=function(){var e=[],t=this.data&&this.data.branding?this.data.branding:{},i=Object.keys(t);return e=i.filter(function(e){return!t[e].blacklisted})},m.prototype.getSplashScreen=function(){var e,t=this.IS_MASTER?"master":"slave";if(this.data&&this.data.branding&&this.data.branding.splash_screen){var i=!0;this.data.branding.splash_screen.image||this.data.branding.splash_screen.url||(i=!1),e={show:i,action:this._getLink("splash_screen").action||function(){}}}else e={show:!0,action:function(){}};return this.messenger._postMessage(["log.branding.splashScreen",{origin:t},null],null,"log"),e},m.prototype.displaySplashScreen=function(e){if("function"!=typeof e)throw Error("argument  passed to displaySplashScreen method should be a function");var t=this.IS_MASTER?"master":"slave",i=this._getLink("logo").image;i&&this.getSplashScreen().show?("master"!==t&&this.messenger._postMessage(["log.branding.displaySplashScreen",{origin:t},null],null,"log"),this.components.displayOnTop({url:i,action:this.getSplashScreen().action,callback:e})):e()},m.prototype._displaySpilBanner=function(e){e=e||{};var t=(e.onportal||!1,"banner_operate2"),i="",a=!1;i=this._getLink("banner_operate2_android").image,navigator.userAgent.match(/Android/i)?(t="banner_operate2_android",i=this._getLink("banner_operate2_android").image,a=!0):(navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))&&(t="banner_operate2_ios",i=this._getLink("banner_operate2_ios").image,a=!0),a&&i!==void 0&&this.components.displayBanner({action:this._getLink(t).action,image:i,eventTracking:this.eventTracking,data:{bannerid:t}})},m.prototype._tagUrl=function(e,t){var i,a,n,s=this.data&&this.data.portal?this.data.portal:{},o=this.data&&this.data.game?this.data.game:{},r=parseInt(s.siteId,10);if("string"!=typeof e)throw Error("No url specified");return i="string"==typeof t?t:"logo",a="brandedgames_"+(r>0&&500>r?"internal":"external"),n=["utm_medium="+a,"utm_campaign="+o.applicationId,"utm_source="+s.host,"utm_content="+i].join("&"),e+=e.indexOf("?")>-1?"&":"?",e+n},f.prototype.encode=function(){var e=["gameapi",this.type,this.callbackId,this.data?JSON.stringify(this.data):""].join("|");return e},S.prototype._postMessage=function(e,t,i){var a,n;a=A.isArray(e)&&"function"==typeof e[e.length-1]?this._callbacks.push(e.pop())-1:t,n=new f({type:i||"jslib",callbackId:a,data:e}).encode();for(var s=0;this._targets.length>s;s++)this._targets[s].postMessage(n,"*")},S.prototype._callJSLib=function(){SpilGames.apply(SpilGames,A.argsToArray(arguments))},S.prototype._setupEventListener=function(){window.addEventListener?window.addEventListener("message",this._handleMessage.bind(this),!1):window.attachEvent&&window.attachEvent("onmessage",this._handleMessage.bind(this))},S.prototype._handleMessage=function(e){var t,i,a,n,s=this,o=new f(e.data);if(o)if(t=o.type,i=o.callbackId,a=o.data,n=this._callbacks[i]||!1,this.IS_MASTER)switch(t){case"jslib":"Array"===a.constructor.name&&a.push(function(e){s._postMessage(e,i)}),this._callJSLib.apply(this,a);break;case"ugapi":this._handleUGARequest(e);break;case"datachange":this._postMessage(a,null,"datachange");break;default:this.publish(t,a)}else this.IS_SLAVE&&("function"==typeof n?(delete this._callbacks[i],n(a)):"datachange"===t||"jslib"!==t&&this.publish(t,a));return!1},S.prototype._handleUGARequest=function(e){var t,i,a,n=this,s=new f(e.data);if(s)switch(t=s.data[0],i=s.callbackId,a=s.data[1]?s.data[1]:null,t){case"GameAPI.data":n._postMessage(this.dataStore._getCache(),i,"ugapi");break;case"GameAPI.isReady":n._postMessage({isready:this.api.isReady},i,"ugapi")}},S.prototype.post=function(){var e=A.argsToArray(arguments);return this.IS_SLAVE?this._postMessage(e):this._callJSLib.apply(this,e),this},S.prototype.publish=function(e,t){return this._channels[e]&&this._channels[e].forEach(function(e){try{e.fn.call(e.ctx,t)}catch(i){}}),this},S.prototype.subscribe=function(e,t,i){if("function"!=typeof t)throw Error("Callback has to be a function");if("string"!=typeof e)throw Error("Channel name has to be a string");return this._channels[e]||(this._channels[e]=[]),this._channels[e].push({fn:t,ctx:i}),this},S.prototype.unsubscribe=function(e,t){return this._channels[e]&&"function"==typeof t&&(this._channels[e]=this._channels[e].filter(function(e){return e.fn!==t})),this},S.prototype.subscribeOnce=function(e,t,i){function a(i){n.unsubscribe(e,a),t.call(this,i)}var n=this;return this.subscribe(e,a,i)},S.prototype.requestFromParent=function(e,t,i){if(!this.IS_SLAVE)throw"You are the parent, stop talking to yourself";t=t||{},this._postMessage([e,t,i],null,"ugapi")},v.prototype._addBasic=function(e,t){var i=t||{};return i.isMaster=this.IS_MASTER,i.isStandalone=this.IS_STANDALONE,i.messenger=this.__.messenger,i.data=null,i},v.prototype._addEventTracking=function(e){var t=e||{};return t.eventTracking=this.__.EventTracking,t},v.prototype._addComponents=function(e){var t=e||{};return t.components=this.__.components,t},v.prototype._addInitialHeight=function(e){var t=e||{};return t.initialHeight=window.outerHeight-window.innerHeight,t},v.prototype._addAppToken=function(e){var t=e||{};return t.appToken=this.AppToken,t},v.prototype._setRole=function(){var e=A.getRole(window);this.IS_MASTER=e.IS_MASTER,this.IS_SLAVE=e.IS_SLAVE,this.IS_STANDALONE=e.IS_STANDALONE},v.prototype._getTargets=function(){if(this.IS_STANDALONE)return[window];if(this.IS_MASTER){for(var e=["iframegame","iframeGameState"],t=null,i=[],a=0;e.length>a;a++)t=document.getElementById(e[a]),t&&t.contentWindow&&i.push(t.contentWindow);return i}return[window.parent]},v.prototype.loadAPI=function(e,t){function a(t){h.IS_MASTER&&(t=n(t));var i=t.portal&&t.portal.gamestate||!1,a=t.game&&t.game.properties&&t.game.properties.highscore||!1,s=t.game&&t.game.properties&&t.game.properties.award||!1;return h.isReady=!0,h.Branding.moduleReady=!0,h.__.EventTracking.moduleReady=!0,h.GameState.moduleReady=!0,h.GameBreak.moduleReady=!0,h.Game.moduleReady=!0,h.Score.moduleReady=!0,h.Award.moduleReady=!0,h.Secondscreen.moduleReady=!0,h.User.moduleReady=!0,h.Friends.moduleReady=!0,h.GameEvent.moduleReady=!0,h.Localization.moduleReady=!0,h.AppToken.moduleReady=!0,(i||a||s)&&h.AppToken.init({data:t}),h.__.EventTracking.init({data:t}),i&&h.GameState.init({data:t}),i||(h.Branding.init({data:t}),h.Game.init({data:t}),h.Score.init({data:t}),h.Award.init({data:t}),h.GameBreak.init({data:t}),h.Friends.init({data:t}),h.User.init({data:t}),h.Localization.init({data:t})),h.__.messenger._postMessage(["log.gameapi.loadapi.finish",{origin:c,version:h.version},null],null,"log"),e(h)}function n(e){var t=e.game||{},i=e.user||{},a=e.portal||{},n=e.branding||{},s=e.localization||{};return b.getLocalConfig({game:t,user:i,portal:a,branding:n,localization:s})}function s(){h.__.messenger.requestFromParent("GameAPI.data",{},function(e){a(e)})}function o(){h.IS_STANDALONE=!0,h.IS_MASTER=!0,h.IS_SLAVE=!0,h.__.dataStore=new i({isMaster:!0}),t=t||null,b.setupStandaloneMode(t,function(e){h.__.dataStore._setCache(n(e)),a(e)})}function r(){h.__.messenger.requestFromParent("GameAPI.isReady",{},function(e){d&&clearTimeout(d),e.isready?s():5>g?(g++,setTimeout(r,500)):(A.log("GameAPI:checkMasterReady not ready but reached max wait"),s())})}function l(e){e&&!e.isError?h.__.dataStore._setCache(n(e)):A.log("GameAPI gameConfig error: ",e.isError),a(e)}function p(e){b.getBrandingConfig(e,l)}var d,h=this,c=this.IS_MASTER?"master":"slave",g=0;if(t!==void 0&&t.id!==void 0&&"576742227280293562"===t.id&&(window.onkeydown=null),"function"!=typeof e)throw Error("argument passed to loadAPI method should be a function");return!0===this.isReady?(A.log("WARNING: Detected multiple executions of GameAPI.loadAPI(). This method should only be executed once per page load!"),e(h)):(this.__.messenger._postMessage(["log.gameapi.loadapi.start",{origin:c,version:h.version,spildata:t},null],null,"log"),this.IS_STANDALONE?o():this.IS_MASTER?b.getGameConfig(p):t&&t.gamestate?a(b.configFromData(t)):(d=setTimeout(o,600),r()),void 0)};var T=new v(i,S,m,u,c);"function"==typeof define&&define.amd&&define("GameAPI",T),e.GameAPI=T})(window),function(){"use strict";function e(e){e&&(e.setTargetValueAtTime||(e.setTargetValueAtTime=e.setTargetAtTime))}window.hasOwnProperty&&window.hasOwnProperty("AudioContext")&&(window.webkitAudioContext=AudioContext,AudioContext.prototype.hasOwnProperty("internal_createGain")||(AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return e(t.gain),t}),AudioContext.prototype.hasOwnProperty("internal_createDelay")||(AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(){var t=this.internal_createDelay();return e(t.delayTime),t}),AudioContext.prototype.hasOwnProperty("internal_createBufferSource")||(AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var t=this.internal_createBufferSource();return t.noteOn||(t.noteOn=t.start),t.noteGrainOn||(t.noteGrainOn=t.start),t.noteOff||(t.noteOff=t.stop),e(t.playbackRate),t}),AudioContext.prototype.hasOwnProperty("internal_createDynamicsCompressor")||(AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return e(t.threshold),e(t.knee),e(t.ratio),e(t.reduction),e(t.attack),e(t.release),t}),AudioContext.prototype.hasOwnProperty("internal_createBiquadFilter")||(AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();
e(t.frequency),e(t.detune),e(t.Q),e(t.gain);for(var i=["LOWPASS","HIGHPASS","BANDPASS","LOWSHELF","HIGHSHELF","PEAKING","NOTCH","ALLPASS"],a=0;i.length>a;++a){var n=i[a],s=n.toLowerCase();t.hasOwnProperty(n)||(t[n]=s)}return t}),AudioContext.prototype.hasOwnProperty("internal_createOscillator")||AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var t=this.internal_createOscillator();t.noteOn||(t.noteOn=t.start),t.noteOff||(t.noteOff=t.stop),e(t.frequency),e(t.detune);for(var i=["SINE","SQUARE","SAWTOOTH","TRIANGLE","CUSTOM"],a=0;i.length>a;++a){var n=i[a],s=n.toLowerCase();t.hasOwnProperty(n)||(t[n]=s)}return t.hasOwnProperty("setWaveTable")||(t.setWaveTable=t.setPeriodicTable),t}),AudioContext.prototype.hasOwnProperty("internal_createPanner")||(AudioContext.prototype.internal_createPanner=AudioContext.prototype.createPanner,AudioContext.prototype.createPanner=function(){var e=this.internal_createPanner(),t={EQUALPOWER:"equalpower",HRTF:"HRTF",LINEAR_DISTANCE:"linear",INVERSE_DISTANCE:"inverse",EXPONENTIAL_DISTANCE:"exponential"};for(var i in t){var a=t[i];e.hasOwnProperty(i)||(e[i]=a)}return e}),AudioContext.prototype.hasOwnProperty("createGainNode")||(AudioContext.prototype.createGainNode=AudioContext.prototype.createGain),AudioContext.prototype.hasOwnProperty("createDelayNode")||(AudioContext.prototype.createDelayNode=AudioContext.prototype.createDelay),AudioContext.prototype.hasOwnProperty("createJavaScriptNode")||(AudioContext.prototype.createJavaScriptNode=AudioContext.prototype.createScriptProcessor),AudioContext.prototype.hasOwnProperty("createWaveTable")||(AudioContext.prototype.createWaveTable=AudioContext.prototype.createPeriodicWave))}();